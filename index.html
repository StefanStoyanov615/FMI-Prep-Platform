<!doctype html>
<html lang="bg">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>FMI Prep Platform</title>
        <link rel="stylesheet" href="style.css" />
    </head>
    <body>
        <nav class="navbar">
            <a href="#" class="brand">FMI Prep Platform</a>
        </nav>

        <div class="container">
            <header class="hero">
                <h1>Платформа за подготовка за кандидастване във ФМИ</h1>
                <p>Бърз достъп до всички изпити и състезания, с които можеш да влезнеш във фми</p>
            </header>

            <section id="uni" class="archive-section">
                <h2 class="section-title">Кандидат-студентски изпити</h2>
                <div id="uni-grid" class="grid">Зареждане...</div>
            </section>

            <section id="matura" class="archive-section">
                <h2 class="section-title">Матури (ДЗИ)</h2>
                <div id="matura-grid" class="grid">Зареждане...</div>
            </section>

            <section id="boyanov" class="archive-section">
                <h2 class="section-title">Турнир "Проф. Б. Боянов"</h2>
                <div id="boyanov-grid" class="grid">Зареждане...</div>
            </section>

            <section id="olympiad" class="archive-section">
                <h2 class="section-title">Олимпиади</h2>
                <div id="olympiad-grid" class="grid">Зареждане...</div>
            </section>
        </div>

        <script>
            window.onload = async () => {
                try {
                    const response = await fetch("registry.json");
                    const data = await response.json();

                    populateGrid("uni-grid", data.ksi || data.university);
                    populateGrid("matura-grid", data.dzi || data.matura);
                    populateGrid("olympiad-grid", data.olimpiadi || data.olympiad);
                    populateGrid("boyanov-grid", data.boyanov);
                } catch (error) {
                    console.error("Грешка:", error);
                    document.querySelector(".container").innerHTML =
                        "<h1>Грешка!</h1><p>Не мога да намеря файл <b>registry.json</b>.</p>";
                }
            };

            function populateGrid(elementId, items) {
                const container = document.getElementById(elementId);

                if (!items || items.length === 0) {
                    container.innerHTML = "<p style='color:#777'>Няма налични материали.</p>";
                    return;
                }

                container.innerHTML = items
                    .map((item) => {
                        const hasAnswers = item.url_answers && item.url_answers.trim() !== "";
                        const hasProblems = item.url_problems && item.url_problems.trim() !== "";

                        return `
                <div class="card">
                    <div class="card-header">
                        <span class="card-year">${item.year}</span>
                        <div class="card-title">${item.title}</div>
                    </div>
                    
                    <div class="card-actions">
                        <!-- Бутон Условие -->
                        ${
                            hasProblems
                                ? `<a href="${item.url_problems}" 
                                  class="btn-card btn-problem" 
                                  target="_blank">
                                  Условие
                               </a>`
                                : `<span class="btn-card btn-disabled">Няма условие</span>`
                        }

                        <!-- Бутон Отговори -->
                        ${
                            hasAnswers
                                ? `<a href="${item.url_answers}" 
                                  class="btn-card btn-answer" 
                                  target="_blank">
                                  Отговори
                               </a>`
                                : ""
                        }
                    </div>
                </div>
                `;
                    })
                    .join("");
            }
        </script>
    </body>
</html>
